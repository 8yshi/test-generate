<!DOCTYPE html>
<html lang="ja">
<head>
     <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂçòË™û„ÉÜ„Çπ„ÉàÂ§™ÈÉé | ÁÑ°Êñô„ÅßCSV„Åã„ÇâÂïèÈ°å‰ΩúÊàê„ÉªÂç∞Âà∑</title>
    <meta name="description" content="CSV„Éï„Ç°„Ç§„É´„Åã„ÇâËã±ÂçòË™û„ÉÜ„Çπ„Éà„ÇíÁÑ°Êñô„ÅßÁ∞°ÂçòÁîüÊàê„ÄÇÁØÑÂõ≤ÊåáÂÆö„ÄÅ„É©„É≥„ÉÄ„É†Âá∫È°å„ÄÅÂç∞Âà∑ÂØæÂøú„ÄÇÂ≠¶Ê†°„ÉªÂ°æ„ÉªÂÄã‰∫∫Â≠¶Áøí„Å´ÊúÄÈÅ©„Å™ÊïôÊùê‰ΩúÊàê„ÉÑ„Éº„É´„ÄÇ">
    <meta name="keywords" content="Ëã±ÂçòË™û„ÉÜ„Çπ„Éà,ÂçòË™ûÂ∏≥,CSV,ÂïèÈ°åÁîüÊàê,Âç∞Âà∑,Ëã±Ë™ûÂ≠¶Áøí,ÊïôÊùê‰ΩúÊàê,ÁÑ°Êñô„ÉÑ„Éº„É´,Â≠¶ÁøíÊîØÊè¥">
    <meta name="author" content="English Test Generator">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://profound-naiad-cc998e.netlify.app/">
    <meta property="og:title" content="ÂçòË™û„ÉÜ„Çπ„ÉàÂ§™ÈÉé | ÁÑ°Êñô„ÅßCSV„Åã„ÇâÂïèÈ°å‰ΩúÊàê">
    <meta property="og:description" content="CSV„Éï„Ç°„Ç§„É´„Åã„ÇâËã±ÂçòË™û„ÉÜ„Çπ„Éà„ÇíÁÑ°Êñô„ÅßÁ∞°ÂçòÁîüÊàê„ÄÇÁØÑÂõ≤ÊåáÂÆö„ÄÅ„É©„É≥„ÉÄ„É†Âá∫È°å„ÄÅÂç∞Âà∑ÂØæÂøú„ÄÇ">
    <meta property="og:site_name" content="Ëã±ÂçòË™û„ÉÜ„Çπ„ÉàÁîüÊàêÂô®">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://profound-naiad-cc998e.netlify.app/">
    <meta property="twitter:title" content="ÂçòË™û„ÉÜ„Çπ„ÉàÂ§™ÈÉé | ÁÑ°Êñô„ÅßCSV„Åã„ÇâÂïèÈ°å‰ΩúÊàê">
    <meta property="twitter:description" content="CSV„Éï„Ç°„Ç§„É´„Åã„ÇâËã±ÂçòË™û„ÉÜ„Çπ„Éà„ÇíÁÑ°Êñô„ÅßÁ∞°ÂçòÁîüÊàê„ÄÇÁØÑÂõ≤ÊåáÂÆö„ÄÅ„É©„É≥„ÉÄ„É†Âá∫È°å„ÄÅÂç∞Âà∑ÂØæÂøú„ÄÇ">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://profound-naiad-cc998e.netlify.app/">
    
    <!-- JSON-LDÊßãÈÄ†Âåñ„Éá„Éº„Çø -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "ÂçòË™û„ÉÜ„Çπ„ÉàÂ§™ÈÉé",
        "description": "CSV„Éï„Ç°„Ç§„É´„Åã„ÇâËã±ÂçòË™û„ÉÜ„Çπ„Éà„ÇíÁÑ°Êñô„ÅßÁ∞°ÂçòÁîüÊàê„Åß„Åç„ÇãWeb„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥",
        "url": "https://profound-naiad-cc998e.netlify.app/",
        "applicationCategory": "EducationalApplication",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "JPY"
        },
        "creator": {
            "@type": "Person",
            "name": "8yshi"
        }
    }
    </script>
    <style>
        body {
            font-family: 'Arial', 'Yu Gothic Medium', 'Hiragino Sans', 'Meiryo', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        h1 {
            text-align: center;
            color: #4a5568;
            margin-bottom: 30px;
            font-size: 2.2em;
        }

        .section {
            margin-bottom: 25px;
            padding: 20px;
            background: #f7fafc;
            border-radius: 10px;
            border-left: 4px solid #4299e1;
        }

        .section h3 {
            margin-top: 0;
            color: #2d3748;
            font-size: 1.3em;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
            cursor: pointer;
            width: 100%;
        }

        .file-input {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-input-button {
            display: inline-block;
            padding: 12px 24px;
            background: #4299e1;
            color: white;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
            width: 100%;
            text-align: center;
            box-sizing: border-box;
        }

        .file-input-button:hover {
            background: #3182ce;
        }

        .input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            align-items: center;
        }

        .input-group label {
            min-width: 100px;
            font-weight: bold;
        }

        input[type="number"], select {
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 16px;
            flex: 1;
        }

        input[type="number"]:focus, select:focus {
            outline: none;
            border-color: #4299e1;
        }

        button {
            background: linear-gradient(135deg, #48bb78, #38a169);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px 5px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(72, 187, 120, 0.4);
        }

        button:disabled {
            background: #a0aec0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .word-count {
            background: #bee3f8;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
        }

        .error {
            color: #e53e3e;
            background: #fed7d7;
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
        }

        .success {
            color: #38a169;
            background: #c6f6d5;
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
        }

        /* Âç∞Âà∑„ÉªË°®Á§∫Áî®„Çπ„Çø„Ç§„É´ */
        .printable-test {
            background: white;
            color: black;
            padding: 30px;
            margin: 20px 0;
            border-radius: 8px;
            font-family: 'Yu Gothic Medium', 'Hiragino Sans', 'Meiryo', sans-serif;
            font-size: 16px;
            line-height: 1.8;
            max-width: 100%;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .test-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #333;
            padding-bottom: 20px;
        }

        .test-title {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .test-info {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .name-score {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
        }

        .test-questions {
            margin: 30px 0;
        }

        .print-question {
            margin-bottom: 20px;
            page-break-inside: avoid;
        }

        .question-text {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
            line-height: 1.3;
        }

        .answer-line {
            border-bottom: 2px solid #333;
            height: 20px;
            margin-top: 5px;
        }

        .answer-section {
            margin-top: 50px;
            border-top: 2px solid #333;
            padding-top: 30px;
        }

        .answer-title {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 30px;
        }

        .answer-item {
            margin-bottom: 10px;
            font-size: 16px;
            line-height: 1.4;
        }

        .print-buttons {
            text-align: center;
            margin: 20px 0;
        }

        .print-footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            font-size: 10px;
            color: #666;
        }

        @media print {
            body {
                background: white !important;
                padding: 0 !important;
            }
            
            .container {
                box-shadow: none !important;
                border-radius: 0 !important;
                padding: 0 !important;
            }
            
            .section {
                display: none !important;
            }
            
            .print-buttons {
                display: none !important;
            }
            
            .printable-test {
                box-shadow: none !important;
                margin: 0 !important;
                padding: 20px !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìö ÂçòË™û„ÉÜ„Çπ„ÉàÂ§™ÈÉé</h1>
        
        <div class="section">
            <h3>üìÅ CSV„Éï„Ç°„Ç§„É´Ë™≠„ÅøËæº„Åø</h3>
            <div class="file-input-wrapper">
                <input type="file" id="csvFile" class="file-input" accept=".csv" />
                <div class="file-input-button">CSV„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</div>
            </div>
            <div id="fileStatus"></div>
        </div>

        <div class="section">
            <h3>‚öôÔ∏è „ÉÜ„Çπ„ÉàË®≠ÂÆö</h3>
            <div class="input-group">
                <label>ÈñãÂßãÁï™Âè∑:</label>
                <input type="number" id="startNum" value="1" min="1">
            </div>
            <div class="input-group">
                <label>ÁµÇ‰∫ÜÁï™Âè∑:</label>
                <input type="number" id="endNum" value="100" min="1">
            </div>
            <div class="input-group">
                <label>ÂïèÈ°åÊï∞:</label>
                <input type="number" id="questionCount" value="20" min="1" max="50">
            </div>
            <div class="input-group">
                <label>Âá∫È°åÂΩ¢Âºè:</label>
                <select id="testType">
                    <option value="english-to-japanese">ÂçòË™û ‚Üí ÊÑèÂë≥</option>
                    <option value="japanese-to-english">ÊÑèÂë≥ ‚Üí ÂçòË™û</option>
                    <option value="mixed">„Éü„ÉÉ„ÇØ„Çπ</option>
                </select>
            </div>
            <div id="rangeStatus" class="word-count"></div>
        </div>

        <div class="section">
            <h3>üéØ „ÉÜ„Çπ„ÉàÁîüÊàê</h3>
            <button id="generateTest" disabled>„ÉÜ„Çπ„ÉàÂïèÈ°å„ÇíÁîüÊàê</button>
            <div id="generateStatus"></div>
        </div>

        <!-- Âç∞Âà∑Áî®„ÉÜ„Çπ„ÉàË°®Á§∫„Ç®„É™„Ç¢ -->
        <div id="printableTest" style="display:none;">
            <div class="print-buttons">
                <button onclick="window.print()">üñ®Ô∏è Âç∞Âà∑„Åô„Çã</button>
                <button onclick="showAnswers()" id="showAnswersBtn">üìù Ëß£Á≠î„ÇíË°®Á§∫</button>
                <button onclick="hideAnswers()" id="hideAnswersBtn" style="display:none;">‚ùå Ëß£Á≠î„ÇíÈö†„Åô</button>
            </div>
            
            <div class="printable-test" id="printTest">
                <div class="test-header">
                    <div class="test-title">ÂçòË™û„ÉÜ„Çπ„Éà</div>
                    <div class="test-info">
                        <span id="printDate"></span>
                        <span id="printQuestionCount"></span>
                    </div>
                    <div class="name-score">
                        <span>ÂêçÂâç: ___________________</span>
                        <span id="printScore"></span>
                    </div>
                </div>
                
                <div class="test-questions" id="printQuestions">
                    <!-- ÂïèÈ°å„Åå„Åì„Åì„Å´ÊåøÂÖ•„Åï„Çå„Çã -->
                </div>
                
                <div class="answer-section" id="answerSection" style="display:none;">
                    <div class="answer-title">Ëß£Á≠î</div>
                    <div id="printAnswers">
                        <!-- Ëß£Á≠î„Åå„Åì„Åì„Å´ÊåøÂÖ•„Åï„Çå„Çã -->
                  </div>
                </div>
                
                <div class="print-footer">
                    Generated by ÂçòË™û„ÉÜ„Çπ„ÉàÂ§™ÈÉé (https://profound-naiad-cc998e.netlify.app)
                </div>
            </div>
        </div>
    </div>

    <script>
        let vocabularyData = [];
        let currentTest = [];

        // CSV„Éï„Ç°„Ç§„É´Ë™≠„ÅøËæº„Åø
        document.getElementById('csvFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(event) {
                try {
                    parseCSV(event.target.result);
                    document.querySelector('.file-input-button').textContent = `ÈÅ∏ÊäûÊ∏à„Åø: ${file.name}`;
                    updateRangeStatus();
                } catch (error) {
                    showError('CSV„Éï„Ç°„Ç§„É´„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ' + error.message);
                }
            };
            reader.readAsText(file, 'UTF-8');
        });

        // CSVËß£Êûê
        function parseCSV(csvText) {
            const lines = csvText.trim().split('\n');
            vocabularyData = [];

            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;

                const columns = parseCSVLine(line);
                
                if (columns.length >= 3) {
                    const num = parseInt(columns[0]);
                    const english = columns[1].trim().replace(/^"|"$/g, '');
                    const japanese = columns[2].trim().replace(/^"|"$/g, '');
                    
                    if (!isNaN(num) && english && japanese) {
                        vocabularyData.push({
                            number: num,
                            english: english,
                            japanese: japanese
                        });
                    }
                }
            }

            if (vocabularyData.length === 0) {
                throw new Error('ÊúâÂäπ„Å™ÂçòË™û„Éá„Éº„Çø„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü');
            }

            vocabularyData.sort((a, b) => a.number - b.number);
            showSuccess(`${vocabularyData.length}ÂÄã„ÅÆÂçòË™û„ÇíË™≠„ÅøËæº„Åø„Åæ„Åó„Åü`);
            
            const maxNum = Math.max(...vocabularyData.map(item => item.number));
            document.getElementById('endNum').value = maxNum;
            
            document.getElementById('generateTest').disabled = false;
        }

        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                
                if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            
            result.push(current);
            return result;
        }

        function updateRangeStatus() {
            const startNum = parseInt(document.getElementById('startNum').value);
            const endNum = parseInt(document.getElementById('endNum').value);
            
            if (vocabularyData.length > 0) {
                const availableWords = vocabularyData.filter(item => 
                    item.number >= startNum && item.number <= endNum
                );
                
                const statusDiv = document.getElementById('rangeStatus');
                statusDiv.textContent = `ÊåáÂÆöÁØÑÂõ≤ÂÜÖ„ÅÆÂçòË™ûÊï∞: ${availableWords.length}ÂÄã`;
                
                const questionCount = parseInt(document.getElementById('questionCount').value);
                if (availableWords.length < questionCount) {
                    statusDiv.textContent += ` (ÂïèÈ°åÊï∞„Çí${availableWords.length}‰ª•‰∏ã„Å´„Åó„Å¶„Åè„Å†„Åï„ÅÑ)`;
                    statusDiv.style.color = '#e53e3e';
                } else {
                    statusDiv.style.color = '#38a169';
                }
            }
        }

        // „ÉÜ„Çπ„ÉàÁîüÊàê
        document.getElementById('generateTest').addEventListener('click', function() {
            try {
                generateTest();
                createPrintableTest();
                showSuccess('„ÉÜ„Çπ„ÉàÂïèÈ°å„ÇíÁîüÊàê„Åó„Åæ„Åó„ÅüÔºÅÂç∞Âà∑„Åæ„Åü„ÅØ„Çπ„ÇØ„É™„Éº„É≥„Ç∑„Éß„ÉÉ„Éà„Åß„ÅîÂà©Áî®„Åè„Å†„Åï„ÅÑ„ÄÇ');
            } catch (error) {
                showError('„ÉÜ„Çπ„ÉàÁîüÊàê„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ' + error.message);
            }
        });

        function generateTest() {
            const startNum = parseInt(document.getElementById('startNum').value);
            const endNum = parseInt(document.getElementById('endNum').value);
            const questionCount = parseInt(document.getElementById('questionCount').value);
            const testType = document.getElementById('testType').value;

            const availableWords = vocabularyData.filter(item => 
                item.number >= startNum && item.number <= endNum
            );

            if (availableWords.length < questionCount) {
                throw new Error(`ÁØÑÂõ≤ÂÜÖ„ÅÆÂçòË™ûÊï∞(${availableWords.length}ÂÄã)„ÅåÂïèÈ°åÊï∞(${questionCount}ÂÄã)„Çà„ÇäÂ∞ë„Å™„ÅÑ„Åß„Åô`);
            }

            const shuffled = availableWords.sort(() => 0.5 - Math.random());
            const selectedWords = shuffled.slice(0, questionCount);

            currentTest = selectedWords.map((word, index) => {
                let questionType;
                if (testType === 'mixed') {
                    questionType = Math.random() < 0.5 ? 'english-to-japanese' : 'japanese-to-english';
                } else {
                    questionType = testType;
                }

                return {
                    number: index + 1,
                    word: word,
                    type: questionType
                };
            });
        }

        function createPrintableTest() {
            const today = new Date();
            const dateStr = `${today.getFullYear()}Âπ¥${today.getMonth() + 1}Êúà${today.getDate()}Êó•`;
            
            // „Éò„ÉÉ„ÉÄ„ÉºÊÉÖÂ†±Ë®≠ÂÆö
            document.getElementById('printDate').textContent = `ÂÆüÊñΩÊó•: ${dateStr}`;
            document.getElementById('printQuestionCount').textContent = `ÂïèÈ°åÊï∞: ${currentTest.length}Âïè`;
            document.getElementById('printScore').textContent = `ÁÇπÊï∞: _____ / ${currentTest.length}`;
            
            // ÂïèÈ°åÁîüÊàê
            const questionsDiv = document.getElementById('printQuestions');
            questionsDiv.innerHTML = '';
            
            currentTest.forEach(item => {
                const question = item.type === 'english-to-japanese' 
                    ? item.word.english 
                    : item.word.japanese;
                
                const questionDiv = document.createElement('div');
                questionDiv.className = 'print-question';
                questionDiv.innerHTML = `
                    <div class="question-text">Âïè${item.number}. ${question}</div>
                    <div>Á≠î„Åà: <span class="answer-line"></span></div>
                `;
                questionsDiv.appendChild(questionDiv);
            });
            
            // Ëß£Á≠îÁîüÊàê
            const answersDiv = document.getElementById('printAnswers');
            answersDiv.innerHTML = '';
            
            currentTest.forEach(item => {
                const answer = item.type === 'english-to-japanese' 
                    ? item.word.japanese 
                    : item.word.english;
                
                const answerDiv = document.createElement('div');
                answerDiv.className = 'answer-item';
                answerDiv.textContent = `Âïè${item.number}. ${answer} (ÂçòË™û${item.word.number})`;
                answersDiv.appendChild(answerDiv);
            });
            
            // Âç∞Âà∑Áî®„Ç®„É™„Ç¢Ë°®Á§∫
            document.getElementById('printableTest').style.display = 'block';
        }

        function showAnswers() {
            document.getElementById('answerSection').style.display = 'block';
            document.getElementById('showAnswersBtn').style.display = 'none';
            document.getElementById('hideAnswersBtn').style.display = 'inline-block';
        }

        function hideAnswers() {
            document.getElementById('answerSection').style.display = 'none';
            document.getElementById('showAnswersBtn').style.display = 'inline-block';
            document.getElementById('hideAnswersBtn').style.display = 'none';
        }

        // ÂÖ•ÂäõÂÄ§Â§âÊõ¥ÊôÇ„Å´ÁØÑÂõ≤Áä∂ÊÖãÊõ¥Êñ∞
        ['startNum', 'endNum', 'questionCount'].forEach(id => {
            document.getElementById(id).addEventListener('input', updateRangeStatus);
        });

        // „É¶„Éº„ÉÜ„Ç£„É™„ÉÜ„Ç£Èñ¢Êï∞
        function showError(message) {
            const statusDiv = document.getElementById('generateStatus') || document.getElementById('fileStatus');
            statusDiv.innerHTML = `<div class="error">${message}</div>`;
        }

        function showSuccess(message) {
            const statusDiv = document.getElementById('generateStatus') || document.getElementById('fileStatus');
            statusDiv.innerHTML = `<div class="success">${message}</div>`;
        }
    </script>
</body>
</html>
